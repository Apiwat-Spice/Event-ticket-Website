<%- include('partials/head') %>
  <style>
    a {
      color: white;
    }
  </style>
  </head>

  <body>

    <%- include('partials/navbar') %>
      <div class="container">


        <h2>โปรไฟล์ของฉัน</h2>
        <p><strong>ชื่อ:</strong>
          <%= currentUser.name %>
        </p>
        <p><strong>อีเมล:</strong>
          <%= currentUser.email %>
        </p>
        <button class="btn btn-dark"><a href="/editprofile">แก้ไขโปรไฟล์</a></button>
        <hr>
        <h4>บัตรของฉัน</h4>
        <% if (!tickets || tickets.length===0) { %>
          <p>ยังไม่มีการจอง</p>
          <% } else { %>
            <div class="row">
              <% tickets.forEach(t=> { %>
                <div class="col-md-6 col-lg-4 mb-4">
                  <div class="card">
                    <div class="card-body">
                      <h5 class="card-title">
                        <%= t.event ? t.event.title : '(อีเวนต์ถูกลบ)' %>
                      </h5>
                      <p class="mb-1">จำนวน: <%= t.quantity %> ใบ</p>
                      <p class="mb-1"><small>วันที่ซื้อ: <%= t.purchasedAt.toLocaleString() %></small></p>

                      <% if (t.qrCodeData) { %>
                        <div class="text-center mt-3">
                          <img src="<%= t.qrCodeData %>" alt="QR Code" style="width: 120px; height: 120px;">
                          <p class="text-muted mt-2 mb-0"><small>QR Ticket ID: <%= t.qrCodeId %></small></p>
                        </div>
                        <% } %>
                    </div>
                  </div>
                </div>
                <% }) %>
            </div>
            <% } %>

      </div>
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  </body>

  </html>